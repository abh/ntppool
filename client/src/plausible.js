var e,t,n,i,r=window.location,a=window.document,o={};function s(){return new URL(e.src).origin+"/api/event"}function u(e){if(o.isInitialized)throw Error("plausible.init() can only be called once");if(!e||!e.domain)throw Error("plausible.init(): domain argument is required");e.endpoint||(e.endpoint="https://plausible.io/api/event"),Object.assign(o,e,{autoCapturePageviews:!1!==e.autoCapturePageviews,logging:!1!==e.logging,bindToWindow:!1!==e.bindToWindow}),o.isInitialized=!0}function c(e,t,n){window.fetch&&fetch(e,{method:"POST",headers:{"Content-Type":"text/plain"},keepalive:!0,body:JSON.stringify(t)}).then(function(e){n&&n.callback&&n.callback({status:e.status})}).catch(function(e){n&&n.callback&&n.callback({error:e})})}var l=!1,d=location.href,f={},p=-1,v=0,w=0;function h(){l&&(b(),n=L(),i=S())}function m(e){t=!1,d=e.u,f=e.p,p=-1,w=0,v=Date.now(),k()}function g(){t=!0}function b(){var e=E();if(!t&&(p<i||e>=3e3)){p=i;var r={n:"engagement",sd:Math.round(i/n*100),d:o.domain,u:d,p:f,e:e,v:24};v=0,w=0,o.hashBasedRouting&&(r.h=1),c(o.endpoint,r)}}function y(){"visible"===document.visibilityState&&document.hasFocus()&&0===v?v=Date.now():"hidden"!==document.visibilityState&&document.hasFocus()||(w=E(),v=0,b())}function k(){l||(document.addEventListener("visibilitychange",y),window.addEventListener("blur",y),window.addEventListener("focus",y),l=!0)}function E(){return v?w+(Date.now()-v):w}function L(){var e=document.body||{},t=document.documentElement||{};return Math.max(e.scrollHeight||0,e.offsetHeight||0,e.clientHeight||0,t.scrollHeight||0,t.offsetHeight||0,t.clientHeight||0)}function S(){var e=document.body||{},t=document.documentElement||{},i=window.innerHeight||t.clientHeight||0,r=window.scrollY||t.scrollTop||e.scrollTop||0;return n<=i?n:r+i}function x(){n=L(),i=S(),window.addEventListener("load",function(){n=L();var e=0,t=setInterval(function(){n=L(),15==++e&&clearInterval(t)},200)}),document.addEventListener("scroll",function(){n=L();var e=S();e>i&&(i=e)})}function track(e,t){if(!o.isInitialized)throw Error("plausible.track() can only be called after plausible.init()");var n,i="pageview"===e;if(i&&h(),!o.captureOnLocalhost){if(/^localhost$|^127(\.[0-9]+){0,2}\.[0-9]+$|^\[::1?\]$/.test(r.hostname)||"file:"===r.protocol)return D(e,t,"localhost");if((window._phantom||window.__nightmare||window.navigator.webdriver||window.Cypress)&&!window.__plausible)return D(e,t)}try{if("true"===window.localStorage.plausible_ignore)return D(e,t,"localStorage flag")}catch(e){}var s={};s.n=e,s.v=24;var u=t&&(t.u||t.url);if(s.u=u||r.href,s.d=o.domain,s.r=a.referrer||null,t&&t.props&&(s.p=t.props),t&&!1===t.interactive&&(s.i=!1),t&&t.revenue&&(s.$=t.revenue),o.customProperties){var n=o.customProperties;"function"==typeof n&&(n=o.customProperties(e)),"object"==typeof n&&(s.p=Object.assign({},n,s.p))}if(o.hashBasedRouting&&(s.h=1),"function"==typeof o.transformRequest&&!(s=o.transformRequest(s)))return D(e,t,"transformRequest");i&&m(s),c(o.endpoint,s,t)}function D(e,t,n){n&&o.logging&&console.warn("Ignoring Event: "+n),t&&t.callback&&t.callback(),"pageview"===e&&g()}var DEFAULT_FILE_TYPES=["pdf","xlsx","docx","txt","rtf","csv","exe","key","pps","ppt","pptx","7z","pkg","rar","gz","zip","avi","mov","mp4","mpeg","wmv","midi","mp3","wav","wma","dmg"],T=1,_=3,N=DEFAULT_FILE_TYPES;function P(e){for(;e&&(void 0===e.tagName||!C(e)||!e.href);)e=e.parentNode;return e}function C(e){return e&&e.tagName&&"a"===e.tagName.toLowerCase()}function F(e,t){if(e.defaultPrevented)return!1;var n=!t.target||t.target.match(/^_(self|parent|top)$/i),i=!(e.ctrlKey||e.metaKey||e.shiftKey)&&"click"===e.type;return n&&i}function H(e){if("auxclick"!==e.type||e.button===T){var t=P(e.target),n=t&&t.href&&t.href.split("?")[0];if(!A(t,0)){if(o.outboundLinks&&R(t))return I(e,t,{name:"Outbound Link: Click",props:{url:t.href}});if(o.fileDownloads&&z(n))return I(e,t,{name:"File Download",props:{url:n}})}}}function I(e,t,n){var i={props:n.props};i.revenue=n.revenue,track(n.name,i)}function R(e){return e&&e.href&&e.host&&e.host!==r.host}function z(e){if(!e)return!1;var t=e.split(".").pop();return N.some(function(e){return e===t})}function O(e){var t=e&&e.classList;if(t){for(var n=0;n<t.length;n++)if(t.item(n).match(/plausible-event-name(=|--)(.+)/))return!0}return!1}function A(e,t){return!!e&&!(t>_)&&(!!O(e)||A(e.parentNode,t+1))}function $(e){var t=O(e)?e:e&&e.parentNode,n={name:null,props:{}};n.revenue={};var i=t&&t.classList;if(!i)return n;for(var r=0;r<i.length;r++){var a=i.item(r),o=a.match(/plausible-event-(.+)(=|--)(.+)/);if(o){var s=o[1],u=o[3].replace(/\+/g," ");"name"==s.toLowerCase()?n.name=u:n.props[s]=u}var c=a.match(/plausible-revenue-(.+)(=|--)(.+)/);if(c){var s=c[1],u=c[3];n.revenue[s]=u}}return n}function j(){function e(e){if("auxclick"!==e.type||e.button===T){for(var t,n,i,r=e.target,a=0;a<=_&&r;a++){if((t=r)&&t.tagName&&"form"===t.tagName.toLowerCase())return;C(r)&&(n=r),O(r)&&(i=r),r=r.parentNode}if(i){var o=$(i);if(n)o.props.url=n.href,I(e,n,o);else{var s={};s.props=o.props,s.revenue=o.revenue,track(o.name,s)}}}}a.addEventListener("click",H),a.addEventListener("auxclick",H),o.fileDownloads&&"object"==typeof o.fileDownloads&&Array.isArray(o.fileDownloads.fileExtensions)&&(N=o.fileDownloads.fileExtensions),o.formSubmissions&&a.addEventListener("submit",function(e){(e.target.hasAttribute("novalidate")||e.target.checkValidity())&&(A(e.target,0)||track("Form: Submission"))},!0),a.addEventListener("submit",function(e){var t,n=$(e.target);if(n.name){var t={props:n.props};t.revenue=n.revenue,track(n.name,t)}}),a.addEventListener("click",e),a.addEventListener("auxclick",e)}function q(track){function e(e){(o.hashBasedRouting||!e||t!==r.pathname)&&(t=r.pathname,track("pageview"))}var t,n=function(){e(!0)};if(o.hashBasedRouting)window.addEventListener("hashchange",n);else{var i=window.history;if(i.pushState){var s=i.pushState;i.pushState=function(){s.apply(this,arguments),n()},window.addEventListener("popstate",n)}}"hidden"===a.visibilityState||"prerender"===a.visibilityState?a.addEventListener("visibilitychange",function(){t||"visible"!==a.visibilityState||e()}):e(),window.addEventListener("pageshow",function(t){t.persisted&&e()})}function init(e){u(e||{}),x(),o.autoCapturePageviews&&q(track),j(),o.bindToWindow&&"undefined"!=typeof window&&(window.plausible=track,window.plausible.l=!0,window.plausible.s="npm",window.plausible.v=24)}
export { init, track, DEFAULT_FILE_TYPES }
